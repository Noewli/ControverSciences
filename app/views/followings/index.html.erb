<% provide(:title, "Mes abonnements") %>
<div id="my-container" class="container-fluid">
<div class="row">
  <div class="col-xs-12 col-lg-8 col-lg-offset-2">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title clearfix">
          <a data-toggle="collapse" href="#collapseOne" class="pull-right glyphicon glyphicon-chevron-up"></a>
          <a data-toggle="collapse" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            Suivre les nouvelles controverses pour les thèmes :
          </a>
        </h3>
      </div>
    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
        <table id="following-new-timelines" class="table table-striped table-hover">
          <tbody class="page">
          <% if !@fo_new_timelines.any? %>
              <tr class="following-new-timeline">
                <td> Vous n'avez pas encore d'abonnements </td>
                <td>  </td>
              </tr>
          <% else %>
              <% @fo_new_timelines.each do |tag| %>
                  <tr class="following-new-timeline">
                    <td> <%= link_to( "<span class=\"icon-#{tag.name}\"></span> ".html_safe+tags_hash[tag.name],
                                                timelines_path(:tag => tag.name),
                                                class: "hvr-grow" )%>
                    </td>
                    <td> <%= link_to "<span class=\"glyphicon glyphicon-trash\">
                                                                </span>".html_safe,
                                     following_new_timeline_path( tag.id ), method: :delete,
                                     data: { confirm: "Etes vous certain ?" } %>  </td>
                  </tr>
              <% end %>
          <% end %>
          </tbody>
        </table>
        <div class="btn-group">
          <button class="btn btn-default dropdown-toggle" type="button"
                  id="dropdownMenuTag" data-toggle="dropdown">
            Ajouter un thème
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" >
            <li>
              <%= link_to 'Tous ', following_new_timelines_path(redirect: true),
                          method: :post %>
            </li>
            <% tags_hash.each do |key, value| %>
                <li>
                  <%= link_to "<span class=\"icon-#{key} hvr-grow\"></span> ".html_safe+value,
                              following_new_timelines_path(tag: key, redirect: true),
                              method: :post %>
                </li>
            <% end %>
          </ul>
        </div>
    </div>
    </div>
  </div>
  <div class="col-xs-12 col-lg-8 col-lg-offset-2">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title clearfix">
          <a data-toggle="collapse" href="#collapseTwo" class="pull-right glyphicon glyphicon-chevron-up"></a>
          <a data-toggle="collapse" href="#collapseTwo" aria-expanded="true" aria-controls="collapseOne">
            Suivre les nouvelles références pour les controverses :
          </a>
        </h3>
      </div>
      <div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
        <table id="following-timelines" class="table table-striped table-hover">
          <tbody class="page">
          <% if !@fo_timelines.any? %>
              <tr class="following-timeline">
                <td> Vous n'avez pas encore d'abonnements </td>
                <td>  </td>
                <td>  </td>
              </tr>
          <% else %>
              <% @fo_timelines.each do |timeline| %>
                  <tr class="following-timeline">
                    <td> <%= link_to timeline.name, timeline_path(timeline.id) %> </td>
                    <td>
                      <% timeline.get_tag_list.each do |name| %>
                           <span class="icon-<%= name %>"></span>
                      <% end %>
                    </td>
                    <td> <%= link_to "<span class=\"glyphicon glyphicon-trash\">
                                                        </span>".html_safe,
                                     following_timeline_path( timeline.id ), method: :delete,
                                     data: { confirm: "Etes vous certain ?" } %>  </td>
                  </tr>
              <% end %>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="col-xs-12 col-lg-8 col-lg-offset-2">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title clearfix">
          <a data-toggle="collapse" href="#collapseThree" class="pull-right glyphicon glyphicon-chevron-up"></a>
          <a data-toggle="collapse" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
            Suivre les nouvelles synthèses pour les controverses :
          </a>
        </h3>
      </div>
      <div id="collapseThree" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
        <table id="following-summary" class="table table-striped table-hover">
          <tbody class="page">
          <% if !@fo_summaries.any? %>
              <tr class="following-summary">
                <td> Vous n'avez pas encore d'abonnements </td>
                <td>  </td>
                <td>  </td>
              </tr>
          <% else %>
              <% @fo_summaries.each do |timeline| %>
                  <tr class="following-timeline">
                    <td> <%= link_to timeline.name, timeline_path(timeline.id) %> </td>
                    <td>
                      <% timeline.get_tag_list.each do |name| %>
                          <span class="icon-<%= name %>"></span>
                      <% end %>
                    </td>
                    <td> <%= link_to "<span class=\"glyphicon glyphicon-trash\">
                                                        </span>".html_safe,
                                     following_summary_path( timeline.id ), method: :delete,
                                     data: { confirm: " Vous êtes certains ?" } %>  </td>
                  </tr>
              <% end %>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
      <div class="col-xs-12 col-lg-8 col-lg-offset-2">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title clearfix">
              <a data-toggle="collapse" href="#collapseFour" class="pull-right glyphicon glyphicon-chevron-up"></a>
              <a data-toggle="collapse" href="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
                Suivre les nouvelles analyses pour les références :
              </a>
            </h3>
          </div>
      <div id="collapseFour" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
        <table id="following-references" class="table table-striped table-hover">
          <tbody class="page">
          <% if !@fo_references.any? %>
              <tr class="following-reference">
                <td> Vous n'avez pas encore d'abonnements </td>
                <td></td>
                <td></td>
              </tr>
          <% else %>
            <% @fo_references.each do |reference| %>
              <tr class="following-reference">
                <td> <%= link_to reference.title, reference_path(reference.id) %>   </td>
                <td> <%= link_to reference.timeline_name, timeline_path(reference.timeline_id ) %>
                <td> <%= link_to "<span class=\"glyphicon glyphicon-trash\">
                                                                </span>".html_safe,
                                 following_reference_path( reference.id ), method: :delete,
                                 data: { confirm: "Etes vous certain ?" } %>  </td>
              </tr>
            <% end %>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
</div>

<script type="text/javascript">
    $('.collapse').on('show.bs.collapse', function () {
        $(this).parent(".panel").find(".glyphicon-chevron-down").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up");

    });
    $('.collapse').on('hide.bs.collapse', function () {
        $(this).parent("div").parent("div").find(".glyphicon-chevron-up").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down");
    });
</script>